# 4 주차

<aside>
💡 프로세스와 스레드는 각각 무엇이고, 둘의 차이는 무엇인가

스프링은 멀티 스레딩 방식으로 동작하는데, 이들 간의 Thread-safe할 수 있는 이유는 무엇인가

스프링 프로젝트를 실행 Run하면 그 시작점은 어디인가

</aside>

- **프로세스와 스레드는 각각 무엇이고, 둘의 차이는 무엇인가**
    
    [프로세스와 스레드의 차이](https://velog.io/@raejoonee/%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EC%99%80-%EC%8A%A4%EB%A0%88%EB%93%9C%EC%9D%98-%EC%B0%A8%EC%9D%B4)
    
    참고 사이트
    
    프로세스란?
    
    실행중인 프로그램이다. (작업의 단위)
    
    실행중이라는 것은 프로그램이 메모리에 적재되어 cpu자원을 할당받아 사용되고 있는 상태를 말한다. cpu는 스케줄링 작업을 통해 메모리에 적재되어 있는 프로세스들의 처리순서를 결정한다.
    
     
    
    프로세스가 메모리에 적제될때, OS로 부터 할당받는 메모리 공간은 총 4가지영역으로 나눠진다.
    
    <  프로세스의 4가지 메모리 공간 >
    
    - 코드 영역(code area) : 프로그래머가 작성한 프로그램이 코드 영역에 작성된다
    - 데이터 영역(data area) : 코드가 실행되면서 사용한 변수나 파일들의 각종 데이터들이 모여있다.
    - 스택 영역(stack area) : 호출한 함수가 종료되면 되돌아올 메모리의 주소를 스택에 저장하거나 변수 사용 범위에 영향을 미치는 영역을 구현 할때 사용된다.
    - 힙 영역(heap area) : 동적으로 할당되는 데이터들을 위해 존재하는 공간이다.
    
    <img src="./images/4주차-1.png">
    
    프로세스 메모리 영역
    
    프로세스(하나의 작업) 내에 여러 프로세스를 두어 여러 작업을 처리할 수 있을까? NO!
    
    **프로세스는 독립된 메모리 공간을 할당받고, 프로세스 간에 메모리 공간을 공유할 수 없는 특성을 가지고 있다.** 따라서, 프로세스는 다른 프로세스의 변수나 자료에 접근할 수 없다!
    
    ---
    
    쓰레드란?
    
    프로세스 안에서 처리되는 실행흐름의 단위
    
    프로세스(하나의 작업) 안에서 처리되는 실행흐름인 쓰레드는 프로세스의 한계를 해결하기 위해 탄생했다. 
    
    **쓰레드는 프로세스와 달리 하나의 프로세스안의 쓰레드들끼리 메모리 공간을 공유하며 사용할 수 있다.** 
    
    stack 영역은 쓰레드마다 각각 할당받고, 나머지 code, data, heap영역은 쓰레드끼리 공유된다.
    
     <img src="./images/4주차-2.png">
    
    쓰레드 메모리 영역
    
- **스프링은 멀티 스레딩 방식으로 동작하는데, 이들 간의 Thread-safe 할 수 있는 이유는 무엇인가**
    
    [스프링 빈은 Thread-safe 할까?](https://alwayspr.tistory.com/m/11)
    
    사용자의 여러요청(각각의 쓰레드) 에 대해 같은 자원을 사용해도 Thread-safe 할 수 있는지 알아보았다. 스프링 컨테이너에서 관리하는 스프링빈의 경우 기본 scope이 싱글톤 패턴으로 생성되고 관리된다. 싱글톤은 여러 쓰레드에 대해 하나의 인스턴스 (즉, 공유객체) 를 생성하기 때문에 동시성 문제에 대해 해방적이지 못할 것 같다는 생각을 했다. 
    
    ---
    
    싱글톤으로 객체를 관리할 때 주의해야할 점은 객체내부에 공유변수를 두지 말아야 한다는 점이다. 공유변수를 두게되면 각각의 쓰레드에 대해 값이 공유되고 객체의 일관성이 깨지는 현상이 발생하기 때문이다. 
    
    - 쓰레드는 stack 영역은 각자 할당받고, heap 영역은 쓰레드 간에 공유된다
    
    여기서 stack영역에는 지역변수, heap영역에는 전역변수가 저장된다. 따라서 전역변수로서 객체의 상태를 변경하려 한다면, Thread-safe 하지 않게 된다. 
    
    객체 내부에 공유변수를 두고, 공유변수의 상태를 직접 변경시키는 가변객체의 형태가 아닌 메소드의 파라미터(지역변수) 로서 상태를 변경시키는 불변객체로서 관리되어야 한다.
    
- **스프링 프로젝트를 실행 Run하면 그 시작점은 어디인가**
    
    [Spring Framework 실행순서](https://javannspring.tistory.com/231)
    
    스프링 프로젝트가 로딩되는 시점에 BeanFactory(최상위 스프링 컨테이너) 에서 @Configuration 어노테이션이 붙은 설정클래스에서 정의한 객체, @Component 어노테이션이 붙은 클래스에 대해 스프링 빈으로 객체를 생성하고, 관리한다.
